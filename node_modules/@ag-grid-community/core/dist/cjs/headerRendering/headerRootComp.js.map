{"version":3,"sources":["../../src/ts/headerRendering/headerRootComp.ts"],"names":[],"mappings":"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","file":"headerRootComp.js","sourcesContent":["import { GridOptionsWrapper } from '../gridOptionsWrapper';\nimport { ColumnController } from '../columnController/columnController';\nimport { Autowired } from '../context/context';\nimport { HeaderContainer } from './headerContainer';\nimport { Events } from '../events';\nimport { Component } from '../widgets/component';\nimport { RefSelector } from '../widgets/componentAnnotations';\nimport { GridApi } from '../gridApi';\nimport { AutoWidthCalculator } from '../rendering/autoWidthCalculator';\nimport { Constants } from '../constants/constants';\nimport { addOrRemoveCssClass, setDisplayed } from '../utils/dom';\nimport { ManagedFocusComponent } from '../widgets/managedFocusComponent';\nimport { HeaderNavigationService, HeaderNavigationDirection } from './header/headerNavigationService';\nimport { exists } from '../utils/generic';\nimport { KeyName } from '../constants/keyName';\nimport { PinnedWidthService } from \"../gridBodyComp/pinnedWidthService\";\nimport { CenterWidthFeature } from \"../gridBodyComp/centerWidthFeature\";\nimport { ControllersService } from \"../controllersService\";\n\nexport type HeaderContainerPosition = 'left' | 'right' | 'center';\n\nexport class HeaderRootComp extends ManagedFocusComponent {\n    private static TEMPLATE = /* html */\n        `<div class=\"ag-header\" role=\"presentation\">\n            <div class=\"ag-pinned-left-header\" ref=\"ePinnedLeftHeader\" role=\"presentation\"></div>\n            <div class=\"ag-header-viewport\" ref=\"eHeaderViewport\" role=\"presentation\">\n                <div class=\"ag-header-container\" ref=\"eHeaderContainer\" role=\"rowgroup\"></div>\n            </div>\n            <div class=\"ag-pinned-right-header\" ref=\"ePinnedRightHeader\" role=\"presentation\"></div>\n        </div>`;\n\n    @RefSelector('ePinnedLeftHeader') private ePinnedLeftHeader: HTMLElement;\n    @RefSelector('ePinnedRightHeader') private ePinnedRightHeader: HTMLElement;\n    @RefSelector('eHeaderContainer') private eHeaderContainer: HTMLElement;\n    @RefSelector('eHeaderViewport') private eHeaderViewport: HTMLElement;\n\n    @Autowired('columnController') private columnController: ColumnController;\n    @Autowired('gridApi') private gridApi: GridApi;\n    @Autowired('autoWidthCalculator') private autoWidthCalculator: AutoWidthCalculator;\n    @Autowired('headerNavigationService') private headerNavigationService: HeaderNavigationService;\n    @Autowired('pinnedWidthService') private pinnedWidthService: PinnedWidthService;\n    @Autowired('controllersService') private controllersService: ControllersService;\n\n    private printLayout: boolean;\n    private headerContainers: Map<HeaderContainerPosition, HeaderContainer> = new Map();\n\n    constructor() {\n        super(HeaderRootComp.TEMPLATE);\n    }\n\n    protected postConstruct(): void {\n        super.postConstruct();\n\n        this.printLayout = this.gridOptionsWrapper.getDomLayout() === Constants.DOM_LAYOUT_PRINT;\n\n        this.gridApi.registerHeaderRootComp(this);\n        this.autoWidthCalculator.registerHeaderRootComp(this);\n\n        this.registerHeaderContainer(\n            new HeaderContainer(this.eHeaderContainer, this.eHeaderViewport, null),\n            'center'\n        );\n\n        this.registerHeaderContainer(\n            new HeaderContainer(this.ePinnedLeftHeader, null, Constants.PINNED_LEFT),\n            'left'\n        );\n\n        this.registerHeaderContainer(\n            new HeaderContainer(this.ePinnedRightHeader, null, Constants.PINNED_RIGHT),\n            'right'\n        );\n\n        this.headerContainers.forEach(\n            container => this.createManagedBean(container)\n        );\n\n        this.headerNavigationService.registerHeaderRoot(this);\n\n        // shotgun way to get labels to change, eg from sum(amount) to avg(amount)\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_DOM_LAYOUT, this.onDomLayoutChanged.bind(this));\n\n        // for setting ag-pivot-on / ag-pivot-off CSS classes\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, this.onPivotModeChanged.bind(this));\n\n        this.addManagedListener(this.eventService, Events.EVENT_LEFT_PINNED_WIDTH_CHANGED, this.onPinnedLeftWidthChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED, this.onPinnedRightWidthChanged.bind(this));\n\n        this.onPivotModeChanged();\n        this.addPreventHeaderScroll();\n\n        this.createManagedBean(new CenterWidthFeature(width => this.eHeaderContainer.style.width = `${width}px`));\n\n        if (this.columnController.isReady()) {\n            this.refreshHeader();\n        }\n\n        this.setupHeaderHeight();\n        this.controllersService.registerHeaderRootComp(this);\n    }\n\n    private setupHeaderHeight(): void {\n        const listener = this.setHeaderHeight.bind(this);\n        listener();\n\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_HEADER_HEIGHT, listener);\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_PIVOT_HEADER_HEIGHT, listener);\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_GROUP_HEADER_HEIGHT, listener);\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_PIVOT_GROUP_HEADER_HEIGHT, listener);\n        this.addManagedListener(this.gridOptionsWrapper, GridOptionsWrapper.PROP_FLOATING_FILTERS_HEIGHT, listener);\n\n        this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, listener);\n    }\n\n    private registerHeaderContainer(headerContainer: HeaderContainer, type: HeaderContainerPosition): void {\n        this.headerContainers.set(type, headerContainer);\n    }\n\n    protected onTabKeyDown(e: KeyboardEvent): void {\n        const isRtl = this.gridOptionsWrapper.isEnableRtl();\n        const direction = e.shiftKey !== isRtl\n            ? HeaderNavigationDirection.LEFT\n            : HeaderNavigationDirection.RIGHT;\n\n        if (this.headerNavigationService.navigateHorizontally(direction, true, e) ||\n            this.focusController.focusNextGridCoreContainer(e.shiftKey)\n        ) {\n            e.preventDefault();\n        }\n     }\n\n    protected handleKeyDown(e: KeyboardEvent): void {\n        let direction: HeaderNavigationDirection | null = null;\n\n        switch (e.key) {\n            case KeyName.LEFT:\n                direction = HeaderNavigationDirection.LEFT;\n            case KeyName.RIGHT:\n                if (!exists(direction)) {\n                    direction = HeaderNavigationDirection.RIGHT;\n                }\n                this.headerNavigationService.navigateHorizontally(direction, false, e);\n                break;\n            case KeyName.UP:\n                direction = HeaderNavigationDirection.UP;\n            case KeyName.DOWN:\n                if (!exists(direction)) {\n                    direction = HeaderNavigationDirection.DOWN;\n                }\n                if (this.headerNavigationService.navigateVertically(direction, null, e)) {\n                    e.preventDefault();\n                }\n                break;\n            default:\n                return;\n        }\n    }\n\n    protected onFocusOut(e: FocusEvent): void {\n        const { relatedTarget } = e;\n        const eGui = this.getGui();\n\n        if (!relatedTarget && eGui.contains(document.activeElement)) { return; }\n\n        if (!eGui.contains(relatedTarget as HTMLElement)) {\n            this.focusController.clearFocusedHeader();\n        }\n    }\n\n    private onDomLayoutChanged(): void {\n        const newValue = this.gridOptionsWrapper.getDomLayout() === Constants.DOM_LAYOUT_PRINT;\n        if (this.printLayout !== newValue) {\n            this.printLayout = newValue;\n            this.refreshHeader();\n        }\n    }\n\n    public setHorizontalScroll(offset: number): void {\n        this.eHeaderContainer.style.transform = `translateX(${offset}px)`;\n    }\n\n    public forEachHeaderElement(callback: (renderedHeaderElement: Component) => void): void {\n        this.headerContainers.forEach(\n            childContainer => childContainer.forEachHeaderElement(callback)\n        );\n    }\n\n    public refreshHeader() {\n        this.headerContainers.forEach(\n            container => container.refresh()\n        );\n    }\n\n    private onPivotModeChanged(): void {\n        const pivotMode = this.columnController.isPivotMode();\n\n        addOrRemoveCssClass(this.getGui(), 'ag-pivot-on', pivotMode);\n        addOrRemoveCssClass(this.getGui(), 'ag-pivot-off', !pivotMode);\n    }\n\n    private setHeaderHeight(): void {\n        const {columnController, gridOptionsWrapper} = this;\n\n        let numberOfFloating = 0;\n        let headerRowCount = columnController.getHeaderRowCount();\n        let totalHeaderHeight: number;\n        let groupHeight: number | null | undefined;\n        let headerHeight: number | null | undefined;\n\n        if (columnController.isPivotMode()) {\n            groupHeight = gridOptionsWrapper.getPivotGroupHeaderHeight();\n            headerHeight = gridOptionsWrapper.getPivotHeaderHeight();\n        } else {\n            const hasFloatingFilters = columnController.hasFloatingFilters();\n\n            if (hasFloatingFilters) {\n                headerRowCount++;\n                numberOfFloating = 1;\n            }\n\n            groupHeight = gridOptionsWrapper.getGroupHeaderHeight();\n            headerHeight = gridOptionsWrapper.getHeaderHeight();\n        }\n\n        const numberOfNonGroups = 1 + numberOfFloating;\n        const numberOfGroups = headerRowCount - numberOfNonGroups;\n\n        totalHeaderHeight = numberOfFloating * gridOptionsWrapper.getFloatingFiltersHeight()!;\n        totalHeaderHeight += numberOfGroups * groupHeight!;\n        totalHeaderHeight += headerHeight!;\n\n        // one extra pixel is needed here to account for the\n        // height of the border\n        const px = `${totalHeaderHeight + 1}px`;\n        this.getGui().style.height = px;\n        this.getGui().style.minHeight = px;\n    }\n\n    // if the user is in floating filter and hits tab a few times, the header can\n    // end up scrolling to show items off the screen, leaving the grid and header\n    // and the grid columns no longer in sync.\n    private addPreventHeaderScroll() {\n        this.addManagedListener(this.eHeaderViewport, 'scroll', () => {\n            // if the header scrolls, the header will be out of sync. so we reset the\n            // header scroll, and then scroll the body, which will in turn set the offset\n            // on the header, giving the impression that the header scrolled as expected.\n            const scrollLeft = this.eHeaderViewport.scrollLeft;\n            if (scrollLeft !== 0) {\n                const gridBodyCon = this.controllersService.getGridBodyController();\n                gridBodyCon.getScrollFeature().scrollHorizontally(scrollLeft);\n                this.eHeaderViewport.scrollLeft = 0;\n            }\n        });\n    }\n\n    public getHeaderContainers(): Map<HeaderContainerPosition, HeaderContainer> {\n        return this.headerContainers;\n    }\n\n    private onPinnedLeftWidthChanged(): void {\n        const displayed = this.pinnedWidthService.getPinnedLeftWidth() > 0;\n        setDisplayed(this.ePinnedLeftHeader, displayed);\n    }\n\n    private onPinnedRightWidthChanged(): void {\n        const displayed = this.pinnedWidthService.getPinnedRightWidth() > 0;\n        setDisplayed(this.ePinnedRightHeader, displayed);\n    }\n}\n"]}