{"version":3,"sources":["../../src/ts/rendering/cellComp.ts"],"names":[],"mappings":"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","file":"cellComp.js","sourcesContent":["import { Column } from \"../entities/column\";\nimport { CellChangedEvent, RowNode } from \"../entities/rowNode\";\nimport { Constants } from \"../constants/constants\";\nimport {\n    CellClickedEvent,\n    CellContextMenuEvent,\n    CellDoubleClickedEvent,\n    CellEditingStartedEvent,\n    CellEvent,\n    CellMouseOutEvent,\n    CellMouseOverEvent,\n    Events,\n    FlashCellsEvent\n} from \"../events\";\nimport { Beans } from \"./beans\";\nimport { Component } from \"../widgets/component\";\nimport { ICellEditorComp, ICellEditorParams } from \"../interfaces/iCellEditor\";\nimport { ICellRendererComp, ICellRendererParams } from \"./cellRenderers/iCellRenderer\";\nimport { CheckboxSelectionComponent } from \"./checkboxSelectionComponent\";\nimport { CellClassParams, ColDef, NewValueParams } from \"../entities/colDef\";\nimport { CellPosition } from \"../entities/cellPosition\";\nimport { CellRangeType, ISelectionHandle, SelectionHandleType } from \"../interfaces/iRangeController\";\nimport { RowController } from \"./row/rowController\";\nimport { RowDragComp } from \"./row/rowDragComp\";\nimport { PopupEditorWrapper } from \"./cellEditors/popupEditorWrapper\";\nimport { AgPromise } from \"../utils\";\nimport { IFrameworkOverrides } from \"../interfaces/iFrameworkOverrides\";\nimport { DndSourceComp } from \"./dndSourceComp\";\nimport { TooltipFeature } from \"../widgets/tooltipFeature\";\nimport { TooltipParentComp } from '../widgets/tooltipFeature';\nimport { setAriaColIndex, setAriaDescribedBy, setAriaSelected } from \"../utils/aria\";\nimport { get, getValueUsingField } from \"../utils/object\";\nimport { escapeString } from \"../utils/string\";\nimport { exists, missing } from \"../utils/generic\";\nimport { addOrRemoveCssClass, clearElement, addStylesToElement, isElementChildOfClass, isFocusableFormField } from \"../utils/dom\";\nimport { last, areEqual, pushAll, includes } from \"../utils/array\";\nimport { cssStyleObjectToMarkup } from \"../utils/general\";\nimport { isStopPropagationForAgGrid, getTarget, isEventSupported } from \"../utils/event\";\nimport { isEventFromPrintableCharacter } from \"../utils/keyboard\";\nimport { isBrowserEdge, isBrowserIE, isIOSUserAgent } from \"../utils/browser\";\nimport { doOnce } from \"../utils/function\";\nimport { KeyCode } from '../constants/keyCode';\nimport { ITooltipParams } from \"./tooltipComponent\";\nimport { RowPosition } from \"../entities/rowPosition\";\n\nconst CSS_CELL = 'ag-cell';\nconst CSS_CELL_VALUE = 'ag-cell-value';\nconst CSS_AUTO_HEIGHT = 'ag-cell-auto-height';\n\nconst CSS_RANGE_TOP = 'ag-cell-range-top';\nconst CSS_RANGE_RIGHT = 'ag-cell-range-right';\nconst CSS_RANGE_BOTTOM = 'ag-cell-range-bottom';\nconst CSS_RANGE_LEFT = 'ag-cell-range-left';\n\nconst CSS_CELL_FOCUS = 'ag-cell-focus';\n\nconst CSS_FIRST_RIGHT_PINNED = 'ag-cell-first-right-pinned';\nconst CSS_LAST_LEFT_PINNED = 'ag-cell-last-left-pinned';\n\nconst CSS_NOT_INLINE_EDITING = 'ag-cell-not-inline-editing';\nconst CSS_INLINE_EDITING = 'ag-cell-inline-editing';\nconst CSS_POPUP_EDITING = 'ag-cell-popup-editing';\n\nconst CSS_RANGE_SELECTED = 'ag-cell-range-selected';\nconst CSS_COLUMN_HOVER = 'ag-column-hover';\nconst CSS_CELL_WRAP_TEXT = 'ag-cell-wrap-text';\n\nconst CSS_RANGE_CHART = 'ag-cell-range-chart';\nconst CSS_RANGE_SINGLE_CELL = 'ag-cell-range-single-cell';\nconst CSS_RANGE_CHART_CATEGORY = 'ag-cell-range-chart-category';\nconst CSS_RANGE_HANDLE = 'ag-cell-range-handle';\n\nexport class CellComp extends Component implements TooltipParentComp {\n\n    public static DOM_DATA_KEY_CELL_COMP = 'cellComp';\n\n    private static CELL_RENDERER_TYPE_NORMAL = 'cellRenderer';\n    private static CELL_RENDERER_TYPE_PINNED = 'pinnedRowCellRenderer';\n\n    private eCellWrapper: HTMLElement;\n    private eCellValue: HTMLElement;\n\n    private beans: Beans;\n    private column: Column;\n    private rowNode: RowNode;\n    private eRow: HTMLElement;\n    private cellPosition: CellPosition;\n    private rangeCount: number;\n    private hasChartRange = false;\n\n    private usingWrapper: boolean;\n    private wrapText: boolean;\n\n    private includeSelectionComponent: boolean;\n    private includeRowDraggingComponent: boolean;\n    private includeDndSourceComponent: boolean;\n\n    private rowDraggingComp: RowDragComp | undefined;\n\n    private cellFocused: boolean;\n    private editingCell = false;\n    private cellEditorInPopup: boolean;\n    private hideEditorPopup: Function | null;\n\n    private createCellRendererFunc: (() => void) | null;\n\n    private lastIPadMouseClickEvent: number;\n\n    // true if we are using a cell renderer\n    private usingCellRenderer: boolean;\n    // the cellRenderer class to use - this is decided once when the grid is initialised\n    private cellRendererType: string;\n\n    // instance of the cellRenderer class\n    private cellRenderer: ICellRendererComp | null | undefined;\n    // the GUI is initially element or string, however once the UI is created, it becomes UI\n    private cellRendererGui: HTMLElement | null;\n    private cellEditor: ICellEditorComp | null;\n    private selectionHandle: ISelectionHandle | null | undefined;\n\n    private autoHeightCell: boolean;\n\n    private firstRightPinned: boolean;\n    private lastLeftPinned: boolean;\n\n    private rowComp: RowController | null;\n\n    private rangeSelectionEnabled: boolean;\n\n    private value: any;\n    private valueFormatted: any;\n    private colsSpanning: Column[];\n    private rowSpan: number;\n\n    private suppressRefreshCell = false;\n\n    private tooltipFeatureEnabled = false;\n    private tooltip: any;\n\n    private scope: any = null;\n\n    private readonly printLayout: boolean;\n\n    // every time we go into edit mode, or back again, this gets incremented.\n    // it's the components way of dealing with the async nature of framework components,\n    // so if a framework component takes a while to be created, we know if the object\n    // is still relevant when creating is finished. eg we could click edit / un-edit 20\n    // times before the first React edit component comes back - we should discard\n    // the first 19.\n    private cellEditorVersion = 0;\n    private cellRendererVersion = 0;\n\n    constructor(scope: any, beans: Beans, column: Column, rowNode: RowNode, rowComp: RowController | null,\n        autoHeightCell: boolean, printLayout: boolean, eRow: HTMLElement, editingRow: boolean) {\n        super();\n        this.scope = scope;\n        this.beans = beans;\n        this.column = column;\n        this.rowNode = rowNode;\n        this.rowComp = rowComp;\n        this.autoHeightCell = autoHeightCell;\n        this.printLayout = printLayout;\n        this.eRow = eRow;\n\n        this.createGridCellVo();\n\n        this.rangeSelectionEnabled = this.beans.rangeController && beans.gridOptionsWrapper.isEnableRangeSelection();\n        this.cellFocused = this.beans.focusController.isCellFocused(this.cellPosition);\n        this.firstRightPinned = this.column.isFirstRightPinned();\n        this.lastLeftPinned = this.column.isLastLeftPinned();\n\n        if (this.rangeSelectionEnabled && this.beans.rangeController) {\n            const { rangeController } = this.beans;\n            this.rangeCount = rangeController.getCellRangeCount(this.cellPosition);\n            this.hasChartRange = this.getHasChartRange();\n        }\n\n        this.getValueAndFormat();\n        this.setUsingWrapper();\n        this.chooseCellRenderer();\n        this.setupColSpan();\n        this.rowSpan = this.column.getRowSpan(this.rowNode);\n\n        this.setTemplate(this.getCreateTemplate());\n\n        this.afterAttached();\n\n        // if we are editing the row, then the cell needs to turn\n        // into edit mode\n        if (editingRow) {\n            this.startEditingIfEnabled();\n        }\n    }\n\n    private getCreateTemplate(): string {\n        const unselectable = !this.beans.gridOptionsWrapper.isEnableCellTextSelection() ? ' unselectable=\"on\"' : '';\n        const templateParts: string[] = [];\n        const col = this.column;\n\n        const width = this.getCellWidth();\n        const left = this.modifyLeftForPrintLayout(this.getCellLeft());\n\n        const valueToRender = this.getInitialValueToRender();\n        const valueSanitised = get(this.column, 'colDef.template', null) ? valueToRender : escapeString(valueToRender);\n        this.tooltip = this.getToolTip();\n        const tooltipSanitised = escapeString(this.tooltip);\n        const colIdSanitised = escapeString(col.getId());\n\n        const stylesFromColDef = this.preProcessStylesFromColDef();\n        const cssClasses = this.getInitialCssClasses();\n\n        const stylesForRowSpanning = this.getStylesForRowSpanning();\n        const colIdxSanitised = escapeString(this.beans.columnController.getAriaColumnIndex(this.column).toString());\n\n        templateParts.push(`<div`);\n        templateParts.push(` tabindex=\"-1\"`);\n        templateParts.push(`${unselectable}`); // THIS IS FOR IE ONLY so text selection doesn't bubble outside of the grid\n        templateParts.push(` role=\"gridcell\"`);\n        templateParts.push(` aria-colindex=\"${colIdxSanitised}\"`);\n\n        templateParts.push(` comp-id=\"${this.getCompId()}\" `);\n        templateParts.push(` col-id=\"${colIdSanitised}\"`);\n        templateParts.push(` class=\"${escapeString(cssClasses.join(' '))}\"`);\n\n        if (this.beans.gridOptionsWrapper.isEnableBrowserTooltips() && exists(tooltipSanitised)) {\n            templateParts.push(` title=\"${tooltipSanitised}\"`);\n        }\n\n        if (this.rangeSelectionEnabled) {\n            templateParts.push(` aria-selected=\"${this.rangeCount ? 'true' : 'false'}\"`);\n        }\n\n        templateParts.push(` style=\"width: ${Number(width)}px; left: ${Number(left)}px; ${escapeString(stylesFromColDef)} ${escapeString(stylesForRowSpanning)}\">`);\n\n        if (this.usingWrapper) {\n            templateParts.push(this.getCellWrapperString(valueSanitised));\n        } else if (valueSanitised != null) {\n            templateParts.push(valueSanitised);\n        }\n\n        templateParts.push(`</div>`);\n\n        return templateParts.join('');\n    }\n\n    private getCellWrapperString(value: string | null = ''): string {\n        const unselectable = !this.beans.gridOptionsWrapper.isEnableCellTextSelection() ? ' unselectable=\"on\"' : '';\n        const wrapper = /* html */\n        `<div ref=\"eCellWrapper\" class=\"ag-cell-wrapper\" role=\"presentation\">\n            <span ref=\"eCellValue\" role=\"presentation\" class=\"${CSS_CELL_VALUE}\"${unselectable}>\n                ${value != null ? value : ''}\n            </span>\n        </div>`;\n\n        return wrapper;\n    }\n\n    private getStylesForRowSpanning(): string {\n        if (this.rowSpan === 1) { return ''; }\n\n        const singleRowHeight = this.beans.gridOptionsWrapper.getRowHeightAsNumber();\n        const totalRowHeight = singleRowHeight * this.rowSpan;\n\n        return `height: ${totalRowHeight}px; z-index: 1;`;\n    }\n\n    public afterAttached(): void {\n\n        // all of these have dependencies on the eGui, so only do them after eGui is set\n        this.addDomData();\n        this.populateTemplate();\n        this.createCellRendererInstance(true);\n        this.angular1Compile();\n        this.refreshHandle();\n\n        if (exists(this.tooltip)) {\n            this.createTooltipFeatureIfNeeded();\n        }\n    }\n\n    private createTooltipFeatureIfNeeded(): void {\n        if (\n            this.beans.gridOptionsWrapper.isEnableBrowserTooltips() ||\n            this.tooltipFeatureEnabled\n        ) { return; }\n\n        this.createManagedBean(new TooltipFeature(this), this.beans.context);\n        this.tooltipFeatureEnabled = true;\n    }\n\n    public onColumnHover(): void {\n        const isHovered = this.beans.columnHoverService.isHovered(this.column);\n        this.addOrRemoveCssClass(CSS_COLUMN_HOVER, isHovered);\n    }\n\n    public onCellChanged(event: CellChangedEvent): void {\n        const eventImpactsThisCell = event.column === this.column;\n        if (eventImpactsThisCell) {\n            this.refreshCell({});\n        }\n    }\n\n    private getCellLeft(): number | null {\n        let mostLeftCol: Column;\n\n        if (this.beans.gridOptionsWrapper.isEnableRtl() && this.colsSpanning) {\n            mostLeftCol = last(this.colsSpanning);\n        } else {\n            mostLeftCol = this.column;\n        }\n\n        return mostLeftCol.getLeft();\n    }\n\n    private getCellWidth(): number {\n        if (!this.colsSpanning) {\n            return this.column.getActualWidth();\n        }\n\n        return this.colsSpanning.reduce((width, col) => width + col.getActualWidth(), 0);\n    }\n\n    public onFlashCells(event: FlashCellsEvent): void {\n        const cellId = this.beans.cellPositionUtils.createId(this.cellPosition);\n        const shouldFlash = event.cells[cellId];\n        if (shouldFlash) {\n            this.animateCell('highlight');\n        }\n    }\n\n    private setupColSpan(): void {\n        // if no col span is active, then we don't set it up, as it would be wasteful of CPU\n        if (missing(this.getComponentHolder().colSpan)) { return; }\n\n        // because we are col spanning, a reorder of the cols can change what cols we are spanning over\n        this.addManagedListener(this.beans.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayColumnsChanged.bind(this));\n        // because we are spanning over multiple cols, we check for width any time any cols width changes.\n        // this is expensive - really we should be explicitly checking only the cols we are spanning over\n        // instead of every col, however it would be tricky code to track the cols we are spanning over, so\n        // because hardly anyone will be using colSpan, am favouring this easier way for more maintainable code.\n        this.addManagedListener(this.beans.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, this.onWidthChanged.bind(this));\n\n        this.colsSpanning = this.getColSpanningList();\n    }\n\n    public getColSpanningList(): Column[] {\n        const colSpan = this.column.getColSpan(this.rowNode);\n        const colsSpanning: Column[] = [];\n\n        // if just one col, the col span is just the column we are in\n        if (colSpan === 1) {\n            colsSpanning.push(this.column);\n        } else {\n            let pointer: Column | null = this.column;\n            const pinned = this.column.getPinned();\n            for (let i = 0; pointer && i < colSpan; i++) {\n                colsSpanning.push(pointer);\n                pointer = this.beans.columnController.getDisplayedColAfter(pointer);\n                if (!pointer || missing(pointer)) {\n                    break;\n                }\n                // we do not allow col spanning to span outside of pinned areas\n                if (pinned !== pointer.getPinned()) {\n                    break;\n                }\n            }\n        }\n\n        return colsSpanning;\n    }\n\n    private onDisplayColumnsChanged(): void {\n        const colsSpanning: Column[] = this.getColSpanningList();\n\n        if (!areEqual(this.colsSpanning, colsSpanning)) {\n            this.colsSpanning = colsSpanning;\n            this.onWidthChanged();\n            this.onLeftChanged(); // left changes when doing RTL\n        }\n    }\n\n    private refreshAriaIndex(): void {\n        const colIdx = this.beans.columnController.getAriaColumnIndex(this.column);\n        setAriaColIndex(this.getGui(), colIdx);\n    }\n\n    private getInitialCssClasses(): string[] {\n        const cssClasses = [CSS_CELL, CSS_NOT_INLINE_EDITING];\n\n        // if we are putting the cell into a dummy container, to work out it's height,\n        // then we don't put the height css in, as we want cell to fit height in that case.\n        if (!this.autoHeightCell) {\n            cssClasses.push(CSS_AUTO_HEIGHT);\n        }\n\n        const doingFocusCss = !this.beans.gridOptionsWrapper.isSuppressCellSelection();\n\n        if (doingFocusCss && this.cellFocused) {\n            // otherwise the class depends on the focus state\n            cssClasses.push(CSS_CELL_FOCUS);\n        }\n\n        if (this.firstRightPinned) {\n            cssClasses.push(CSS_FIRST_RIGHT_PINNED);\n        }\n\n        if (this.lastLeftPinned) {\n            cssClasses.push(CSS_LAST_LEFT_PINNED);\n        }\n\n        if (this.beans.columnHoverService.isHovered(this.column)) {\n            cssClasses.push(CSS_COLUMN_HOVER);\n        }\n\n        pushAll(cssClasses, this.preProcessClassesFromColDef());\n        pushAll(cssClasses, this.preProcessCellClassRules());\n        pushAll(cssClasses, this.getInitialRangeClasses());\n\n        // if using the wrapper, this class goes on the wrapper instead\n        if (!this.usingWrapper) {\n            cssClasses.push(CSS_CELL_VALUE);\n        }\n\n        this.wrapText = this.column.getColDef().wrapText == true;\n        if (this.wrapText) {\n            cssClasses.push(CSS_CELL_WRAP_TEXT);\n        }\n\n        return cssClasses;\n    }\n\n    public getInitialValueToRender(): string {\n        // if using a cellRenderer, then render the html from the cell renderer if it exists\n        if (this.usingCellRenderer) {\n            if (typeof this.cellRendererGui === 'string') {\n                return this.cellRendererGui as string;\n            }\n            return '';\n        }\n\n        const colDef = this.getComponentHolder();\n\n        if (colDef.template) {\n            // template is really only used for angular 1 - as people using ng1 are used to providing templates with\n            // bindings in it. in ng2, people will hopefully want to provide components, not templates.\n            return colDef.template;\n        }\n\n        if (colDef.templateUrl) {\n            // likewise for templateUrl - it's for ng1 really - when we move away from ng1, we can take these out.\n            // niall was pro angular 1 when writing template and templateUrl, if writing from scratch now, would\n            // not do these, but would follow a pattern that was friendly towards components, not templates.\n            const template = this.beans.templateService.getTemplate(colDef.templateUrl, this.refreshCell.bind(this, true));\n\n            return template || '';\n        }\n\n        return this.getValueToUse();\n    }\n\n    public getRenderedRow(): RowController | null {\n        return this.rowComp;\n    }\n\n    public isSuppressNavigable(): boolean {\n        return this.column.isSuppressNavigable(this.rowNode);\n    }\n\n    public getCellRenderer(): ICellRendererComp | null | undefined {\n        return this.cellRenderer;\n    }\n\n    public getCellEditor(): ICellEditorComp | null {\n        return this.cellEditor;\n    }\n\n    public onNewColumnsLoaded(): void {\n        this.postProcessWrapText();\n        this.postProcessCellClassRules();\n    }\n\n    private postProcessWrapText(): void {\n        const newValue = this.column.getColDef().wrapText == true;\n        if (newValue !== this.wrapText) {\n            this.wrapText = newValue;\n            this.addOrRemoveCssClass(CSS_CELL_WRAP_TEXT, this.wrapText);\n        }\n    }\n\n    // + stop editing {forceRefresh: true, suppressFlash: true}\n    // + event cellChanged {}\n    // + cellRenderer.params.refresh() {} -> method passes 'as is' to the cellRenderer, so params could be anything\n    // + rowComp: event dataChanged {animate: update, newData: !update}\n    // + rowComp: api refreshCells() {animate: true/false}\n    // + rowRenderer: api softRefreshView() {}\n    public refreshCell(params?: { suppressFlash?: boolean, newData?: boolean, forceRefresh?: boolean; }) {\n        // if we are in the middle of 'stopEditing', then we don't refresh here, as refresh gets called explicitly\n        if (this.suppressRefreshCell || this.editingCell) { return; }\n\n        const colDef = this.getComponentHolder();\n        const newData = params && params.newData;\n        const suppressFlash = (params && params.suppressFlash) || colDef.suppressCellFlash;\n        // we always refresh if cell has no value - this can happen when user provides Cell Renderer and the\n        // cell renderer doesn't rely on a value, instead it could be looking directly at the data, or maybe\n        // printing the current time (which would be silly)???. Generally speaking\n        // non of {field, valueGetter, showRowGroup} is bad in the users application, however for this edge case, it's\n        // best always refresh and take the performance hit rather than never refresh and users complaining in support\n        // that cells are not updating.\n        const noValueProvided = colDef.field == null && colDef.valueGetter == null && colDef.showRowGroup == null;\n        const forceRefresh = (params && params.forceRefresh) || noValueProvided || newData;\n\n        const oldValue = this.value;\n\n        // get latest value without invoking the value formatter as we may not be updating the cell\n        this.value = this.getValue();\n\n        // for simple values only (not objects), see if the value is the same, and if it is, skip the refresh.\n        // when never allow skipping after an edit, as after editing, we need to put the GUI back to the way\n        // if was before the edit.\n        const valuesDifferent = !this.valuesAreEqual(oldValue, this.value);\n        const dataNeedsUpdating = forceRefresh || valuesDifferent;\n\n        if (dataNeedsUpdating) {\n            // now invoke the value formatter as we are going to update cell\n            this.valueFormatted = this.beans.valueFormatterService.formatValue(this.column, this.rowNode, this.scope, this.value);\n\n            // if it's 'new data', then we don't refresh the cellRenderer, even if refresh method is available.\n            // this is because if the whole data is new (ie we are showing stock price 'BBA' now and not 'SSD')\n            // then we are not showing a movement in the stock price, rather we are showing different stock.\n            const cellRendererRefreshed = newData ? false : this.attemptCellRendererRefresh();\n\n            // we do the replace if not doing refresh, or if refresh was unsuccessful.\n            // the refresh can be unsuccessful if we are using a framework (eg ng2 or react) and the framework\n            // wrapper has the refresh method, but the underlying component doesn't\n            if (!cellRendererRefreshed) {\n                this.replaceContentsAfterRefresh();\n            }\n\n            // we don't want to flash the cells when processing a filter change, as otherwise the UI would\n            // be to busy. see comment in FilterManager with regards processingFilterChange\n            const processingFilterChange = this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();\n\n            const flashCell = !suppressFlash && !processingFilterChange &&\n                (this.beans.gridOptionsWrapper.isEnableCellChangeFlash() || colDef.enableCellChangeFlash);\n\n            if (flashCell) {\n                this.flashCell();\n            }\n\n            // need to check rules. note, we ignore colDef classes and styles, these are assumed to be static\n            this.postProcessStylesFromColDef();\n            this.postProcessClassesFromColDef();\n        }\n\n        // we can't readily determine if the data in an angularjs template has changed, so here we just update\n        // and recompile (if applicable)\n        this.updateAngular1ScopeAndCompile();\n\n        this.refreshToolTip();\n        // we do cellClassRules even if the value has not changed, so that users who have rules that\n        // look at other parts of the row (where the other part of the row might of changed) will work.\n        this.postProcessCellClassRules();\n    }\n\n    // user can also call this via API\n    public flashCell(delays?: { flashDelay?: number | null; fadeDelay?: number | null; }): void {\n        const flashDelay = delays && delays.flashDelay;\n        const fadeDelay = delays && delays.fadeDelay;\n\n        this.animateCell('data-changed', flashDelay, fadeDelay);\n    }\n\n    private animateCell(cssName: string, flashDelay?: number | null, fadeDelay?: number | null): void {\n        const fullName = `ag-cell-${cssName}`;\n        const animationFullName = `ag-cell-${cssName}-animation`;\n        const element = this.getGui();\n        const { gridOptionsWrapper } = this.beans;\n\n        if (!flashDelay) {\n            flashDelay = gridOptionsWrapper.getCellFlashDelay();\n        }\n\n        if (!exists(fadeDelay)) {\n            fadeDelay = gridOptionsWrapper.getCellFadeDelay();\n        }\n\n        // we want to highlight the cells, without any animation\n        this.addCssClass(fullName);\n        this.removeCssClass(animationFullName);\n\n        // then once that is applied, we remove the highlight with animation\n        window.setTimeout(() => {\n            this.removeCssClass(fullName);\n            this.addCssClass(animationFullName);\n            element.style.transition = `background-color ${fadeDelay}ms`;\n            window.setTimeout(() => {\n                // and then to leave things as we got them, we remove the animation\n                this.removeCssClass(animationFullName);\n                element.style.removeProperty('transition');\n            }, fadeDelay!);\n        }, flashDelay);\n    }\n\n    private replaceContentsAfterRefresh(): void {\n        this.setUsingWrapper();\n        clearElement(this.eCellValue);\n\n        // remove old renderer component if it exists\n        this.cellRenderer = this.beans.context.destroyBean(this.cellRenderer);\n        this.cellRendererGui = null;\n\n        // populate\n        this.putDataIntoCellAfterRefresh();\n        this.updateAngular1ScopeAndCompile();\n    }\n\n    private updateAngular1ScopeAndCompile() {\n        if (this.beans.gridOptionsWrapper.isAngularCompileRows() && this.scope) {\n            this.scope.data = { ...this.rowNode.data };\n            this.angular1Compile();\n        }\n    }\n\n    private angular1Compile(): void {\n        // if angular compiling, then need to also compile the cell again (angular compiling sucks, please wait...)\n        if (this.beans.gridOptionsWrapper.isAngularCompileRows()) {\n            const eGui = this.getGui();\n\n            // only compile the node if it hasn't already been done\n            // this prevents \"orphaned\" node leaks\n            if (!eGui.classList.contains('ng-scope') || eGui.childElementCount === 0) {\n                const compiledElement = this.beans.$compile(eGui)(this.scope);\n                this.addDestroyFunc(() => compiledElement.remove());\n            }\n        }\n    }\n\n    private postProcessStylesFromColDef() {\n        const stylesToUse = this.processStylesFromColDef();\n\n        if (stylesToUse) {\n            addStylesToElement(this.getGui(), stylesToUse);\n        }\n    }\n\n    private preProcessStylesFromColDef(): string {\n        return cssStyleObjectToMarkup(this.processStylesFromColDef());\n    }\n\n    private processStylesFromColDef(): any {\n        const colDef = this.getComponentHolder();\n\n        if (colDef.cellStyle) {\n            let cssToUse: any;\n\n            if (typeof colDef.cellStyle === 'function') {\n                const cellStyleParams = {\n                    column: this.column,\n                    value: this.value,\n                    colDef: colDef,\n                    data: this.rowNode.data,\n                    node: this.rowNode,\n                    rowIndex: this.rowNode.rowIndex!,\n                    $scope: this.scope,\n                    api: this.beans.gridOptionsWrapper.getApi()!,\n                    columnApi: this.beans.gridOptionsWrapper.getColumnApi()!,\n                    context: this.beans.gridOptionsWrapper.getContext(),\n                } as CellClassParams;\n                const cellStyleFunc = colDef.cellStyle as Function;\n                cssToUse = cellStyleFunc(cellStyleParams);\n            } else {\n                cssToUse = colDef.cellStyle;\n            }\n\n            return cssToUse;\n        }\n    }\n\n    private postProcessClassesFromColDef() {\n        this.processClassesFromColDef(className => this.addCssClass(className));\n    }\n\n    private preProcessClassesFromColDef(): string[] {\n        const res: string[] = [];\n\n        this.processClassesFromColDef(className => res.push(className));\n\n        return res;\n    }\n\n    private processClassesFromColDef(onApplicableClass: (className: string) => void): void {\n        const colDef = this.getComponentHolder();\n        const cellClassParams: CellClassParams = {\n            value: this.value,\n            data: this.rowNode.data,\n            node: this.rowNode,\n            colDef: colDef,\n            rowIndex: this.rowNode.rowIndex!,\n            $scope: this.scope,\n            api: this.beans.gridOptionsWrapper.getApi()!,\n            columnApi: this.beans.gridOptionsWrapper.getColumnApi()!,\n            context: this.beans.gridOptionsWrapper.getContext()\n        };\n\n        this.beans.stylingService.processStaticCellClasses(\n            colDef,\n            cellClassParams,\n            onApplicableClass\n        );\n    }\n\n    private putDataIntoCellAfterRefresh() {\n        // template gets preference, then cellRenderer, then do it ourselves\n        const colDef = this.getComponentHolder();\n\n        if (colDef.template) {\n            // template is really only used for angular 1 - as people using ng1 are used to providing templates with\n            // bindings in it. in ng2, people will hopefully want to provide components, not templates.\n            this.eCellValue.innerHTML = colDef.template;\n        } else if (colDef.templateUrl) {\n            // likewise for templateUrl - it's for ng1 really - when we move away from ng1, we can take these out.\n            // niall was pro angular 1 when writing template and templateUrl, if writing from scratch now, would\n            // not do these, but would follow a pattern that was friendly towards components, not templates.\n            const template = this.beans.templateService.getTemplate(colDef.templateUrl, this.refreshCell.bind(this, true));\n\n            if (template) {\n                this.eCellValue.innerHTML = template;\n            }\n        } else {\n            // we can switch from using a cell renderer back to the default if a user\n            // is using cellRendererSelect\n            this.chooseCellRenderer();\n\n            if (this.usingCellRenderer) {\n                this.createCellRendererInstance();\n            } else {\n                const valueToUse = this.getValueToUse();\n\n                if (valueToUse != null) {\n                    this.eCellValue.innerHTML = escapeString(valueToUse) || '';\n                }\n            }\n        }\n    }\n\n    public attemptCellRendererRefresh(): boolean {\n        if (missing(this.cellRenderer) || !this.cellRenderer || missing(this.cellRenderer.refresh)) {\n            return false;\n        }\n\n        // if the cell renderer has a refresh method, we call this instead of doing a refresh\n        const params = this.createCellRendererParams();\n\n        // take any custom params off of the user\n        const finalParams = this.beans.userComponentFactory.createFinalParams(this.getComponentHolder(), this.cellRendererType, params);\n\n        const result: boolean | void = this.cellRenderer.refresh(finalParams);\n\n        // NOTE on undefined: previous version of the cellRenderer.refresh() interface\n        // returned nothing, if the method existed, we assumed it refreshed. so for\n        // backwards compatibility, we assume if method exists and returns nothing,\n        // that it was successful.\n        return result === true || result === undefined;\n    }\n\n    private refreshToolTip() {\n        const newTooltip = this.getToolTip();\n\n        if (this.tooltip === newTooltip) { return; }\n\n        this.createTooltipFeatureIfNeeded();\n\n        const hasNewTooltip = exists(newTooltip);\n\n        if (hasNewTooltip && this.tooltip === newTooltip!.toString()) { return; }\n\n        this.tooltip = newTooltip;\n\n        if (this.beans.gridOptionsWrapper.isEnableBrowserTooltips()) {\n            if (hasNewTooltip) {\n                this.eCellValue.setAttribute('title', this.tooltip);\n            } else {\n                this.eCellValue.removeAttribute('title');\n            }\n        }\n    }\n\n    private valuesAreEqual(val1: any, val2: any): boolean {\n        // if the user provided an equals method, use that, otherwise do simple comparison\n        const colDef = this.getComponentHolder();\n        const equalsMethod = colDef ? colDef.equals : null;\n\n        return equalsMethod ? equalsMethod(val1, val2) : val1 === val2;\n    }\n\n    private getToolTip(): string | null {\n        const colDef = this.getComponentHolder();\n        const data = this.rowNode.data;\n\n        if (colDef.tooltipField && exists(data)) {\n            return getValueUsingField(data, colDef.tooltipField, this.column.isTooltipFieldContainsDots());\n        }\n\n        const valueGetter = colDef.tooltipValueGetter;\n\n        if (valueGetter) {\n            return valueGetter({\n                api: this.beans.gridOptionsWrapper.getApi(),\n                columnApi: this.beans.gridOptionsWrapper.getColumnApi(),\n                context: this.beans.gridOptionsWrapper.getContext(),\n                ...this.getTooltipParams(),\n                value: this.value\n            });\n        }\n\n        return null;\n    }\n\n    public getTooltipParams(): ITooltipParams {\n        return {\n            location: 'cell',\n            colDef: this.getComponentHolder(),\n            column: this.getColumn(),\n            rowIndex: this.cellPosition.rowIndex,\n            node: this.rowNode,\n            data: this.rowNode.data,\n            value: this.getTooltipText(),\n            valueFormatted: this.valueFormatted,\n        };\n    }\n\n    private getTooltipText(escape: boolean = true) {\n        return escape ? escapeString(this.tooltip) : this.tooltip;\n    }\n\n    private processCellClassRules(onApplicableClass: (className: string) => void, onNotApplicableClass?: (className: string) => void): void {\n        const colDef = this.getComponentHolder();\n        const cellClassParams: CellClassParams = {\n            value: this.value,\n            data: this.rowNode.data,\n            node: this.rowNode,\n            colDef: colDef,\n            rowIndex: this.cellPosition.rowIndex,\n            api: this.beans.gridOptionsWrapper.getApi()!,\n            columnApi: this.beans.gridOptionsWrapper.getColumnApi()!,\n            $scope: this.scope,\n            context: this.beans.gridOptionsWrapper.getContext()\n        };\n\n        this.beans.stylingService.processClassRules(\n            colDef.cellClassRules,\n            cellClassParams,\n            onApplicableClass,\n            onNotApplicableClass\n        );\n    }\n\n    private postProcessCellClassRules(): void {\n        this.processCellClassRules(\n            className => this.addCssClass(className),\n            className => this.removeCssClass(className)\n        );\n    }\n\n    private preProcessCellClassRules(): string[] {\n        const res: string[] = [];\n\n        this.processCellClassRules(\n            className => res.push(className),\n            _ => {\n                // not catered for, if creating, no need\n                // to remove class as it was never there\n            }\n        );\n\n        return res;\n    }\n\n    // a wrapper is used when we are putting a selection checkbox in the cell with the value\n    public setUsingWrapper(): void {\n        const colDef = this.getComponentHolder();\n\n        // never allow selection or dragging on pinned rows\n        if (this.rowNode.rowPinned) {\n            this.usingWrapper = false;\n            this.includeSelectionComponent = false;\n            this.includeRowDraggingComponent = false;\n            this.includeDndSourceComponent = false;\n            return;\n        }\n\n        const cbSelectionIsFunc = typeof colDef.checkboxSelection === 'function';\n        const rowDraggableIsFunc = typeof colDef.rowDrag === 'function';\n        const dndSourceIsFunc = typeof colDef.dndSource === 'function';\n\n        this.includeSelectionComponent = cbSelectionIsFunc || colDef.checkboxSelection === true;\n        this.includeRowDraggingComponent = rowDraggableIsFunc || colDef.rowDrag === true;\n        this.includeDndSourceComponent = dndSourceIsFunc || colDef.dndSource === true;\n\n        const enableTextSelection = this.beans.gridOptionsWrapper.isEnableCellTextSelection();\n\n        this.usingWrapper = enableTextSelection || this.includeRowDraggingComponent || this.includeSelectionComponent || this.includeDndSourceComponent;\n    }\n\n    private chooseCellRenderer(): void {\n        // template gets preference, then cellRenderer, then do it ourselves\n        const colDef = this.getComponentHolder();\n\n        // templates are for ng1, ideally we wouldn't have these, they are ng1 support\n        // inside the core which is bad\n        if (colDef.template || colDef.templateUrl) {\n            this.usingCellRenderer = false;\n            return;\n        }\n\n        const params = this.createCellRendererParams();\n\n        if (this.rowNode.rowPinned &&\n            this.beans.userComponentFactory.lookupComponentClassDef(colDef, 'pinnedRowCellRenderer', params)) {\n            this.cellRendererType = CellComp.CELL_RENDERER_TYPE_PINNED;\n            this.usingCellRenderer = true;\n        } else if (this.beans.userComponentFactory.lookupComponentClassDef(colDef, 'cellRenderer', params)) {\n            this.cellRendererType = CellComp.CELL_RENDERER_TYPE_NORMAL;\n            this.usingCellRenderer = true;\n        } else {\n            this.usingCellRenderer = false;\n        }\n    }\n\n    private createCellRendererInstance(useTaskService = false): void {\n        if (!this.usingCellRenderer) { return; }\n\n        // never use task service if angularCompileRows=true, as that assume the cell renderers\n        // are finished when the row is created. also we never use it if animation frame service\n        // is turned off.\n        // and lastly we never use it if doing auto-height, as the auto-height service checks the\n        // row height directly after the cell is created, it doesn't wait around for the tasks to complete\n        const angularCompileRows = this.beans.gridOptionsWrapper.isAngularCompileRows();\n        const suppressAnimationFrame = this.beans.gridOptionsWrapper.isSuppressAnimationFrame();\n\n        if (angularCompileRows || suppressAnimationFrame || this.autoHeightCell) { useTaskService = false; }\n\n        const params = this.createCellRendererParams();\n\n        this.cellRendererVersion++;\n\n        const callback = this.afterCellRendererCreated.bind(this, this.cellRendererVersion);\n        const cellRendererTypeNormal = this.cellRendererType === CellComp.CELL_RENDERER_TYPE_NORMAL;\n\n        this.createCellRendererFunc = () => {\n            this.createCellRendererFunc = null;\n            // this can return null in the event that the user has switched from a renderer component to nothing, for example\n            // when using a cellRendererSelect to return a component or null depending on row data etc\n            const componentPromise = this.beans.userComponentFactory.newCellRenderer(\n                this.getComponentHolder(), params, !cellRendererTypeNormal);\n\n            if (componentPromise) {\n                componentPromise.then(callback);\n            }\n        };\n\n        if (useTaskService) {\n            this.beans.taskQueue.createTask(this.createCellRendererFunc, this.rowNode.rowIndex!, 'createTasksP2');\n        } else {\n            this.createCellRendererFunc();\n        }\n    }\n\n    private afterCellRendererCreated(cellRendererVersion: number, cellRenderer: ICellRendererComp): void {\n        const cellRendererNotRequired = !this.isAlive() || cellRendererVersion !== this.cellRendererVersion;\n\n        if (cellRendererNotRequired) {\n            this.beans.context.destroyBean(cellRenderer);\n            return;\n        }\n\n        this.cellRenderer = cellRenderer;\n        this.cellRendererGui = this.cellRenderer.getGui();\n\n        if (missing(this.cellRendererGui)) {\n            return;\n        }\n\n        // if async components, then it's possible the user started editing since this call was made\n        if (!this.editingCell) {\n            this.eCellValue.appendChild(this.cellRendererGui);\n        }\n    }\n\n    private createCellRendererParams(): ICellRendererParams {\n        return {\n            value: this.value,\n            valueFormatted: this.valueFormatted,\n            getValue: this.getValue.bind(this),\n            setValue: value => this.beans.valueService.setValue(this.rowNode, this.column, value),\n            formatValue: this.formatValue.bind(this),\n            data: this.rowNode.data,\n            node: this.rowNode,\n            colDef: this.getComponentHolder(),\n            column: this.column,\n            $scope: this.scope,\n            rowIndex: this.cellPosition.rowIndex,\n            api: this.beans.gridOptionsWrapper.getApi(),\n            columnApi: this.beans.gridOptionsWrapper.getColumnApi(),\n            context: this.beans.gridOptionsWrapper.getContext(),\n            refreshCell: this.refreshCell.bind(this),\n\n            eGridCell: this.getGui(),\n            eParentOfValue: this.eCellValue,\n\n            registerRowDragger: (rowDraggerElement, dragStartPixels) => this.addRowDragging(rowDraggerElement, dragStartPixels),\n\n            // these bits are not documented anywhere, so we could drop them?\n            // it was in the olden days to allow user to register for when rendered\n            // row was removed (the row comp was removed), however now that the user\n            // can provide components for cells, the destroy method gets call when this\n            // happens so no longer need to fire event.\n            addRowCompListener: this.rowComp ? this.rowComp.addEventListener.bind(this.rowComp) : null,\n            addRenderedRowListener: (eventType: string, listener: Function) => {\n                console.warn('AG Grid: since AG Grid .v11, params.addRenderedRowListener() is now params.addRowCompListener()');\n                if (this.rowComp) {\n                    this.rowComp.addEventListener(eventType, listener);\n                }\n            }\n        } as ICellRendererParams;\n    }\n\n    private formatValue(value: any): any {\n        const valueFormatted = this.beans.valueFormatterService.formatValue(this.column, this.rowNode, this.scope, value);\n\n        return valueFormatted != null ? valueFormatted : value;\n    }\n\n    private getValueToUse(): any {\n        return this.valueFormatted != null ? this.valueFormatted : this.value;\n    }\n\n    private getValueAndFormat(): void {\n        this.value = this.getValue();\n        this.valueFormatted = this.beans.valueFormatterService.formatValue(this.column, this.rowNode, this.scope, this.value);\n    }\n\n    private getValue(): any {\n        // if we don't check this, then the grid will render leaf groups as open even if we are not\n        // allowing the user to open leaf groups. confused? remember for pivot mode we don't allow\n        // opening leaf groups, so we have to force leafGroups to be closed in case the user expanded\n        // them via the API, or user user expanded them in the UI before turning on pivot mode\n        const lockedClosedGroup = this.rowNode.leafGroup && this.beans.columnController.isPivotMode();\n\n        const isOpenGroup = this.rowNode.group && this.rowNode.expanded && !this.rowNode.footer && !lockedClosedGroup;\n\n        // are we showing group footers\n        const groupFootersEnabled = this.beans.gridOptionsWrapper.isGroupIncludeFooter();\n\n        // if doing footers, we normally don't show agg data at group level when group is open\n        const groupAlwaysShowAggData = this.beans.gridOptionsWrapper.isGroupSuppressBlankHeader();\n\n        // if doing grouping and footers, we don't want to include the agg value\n        // in the header when the group is open\n        const ignoreAggData = (isOpenGroup && groupFootersEnabled) && !groupAlwaysShowAggData;\n\n        const value = this.beans.valueService.getValue(this.column, this.rowNode, false, ignoreAggData);\n\n        return value;\n    }\n\n    public onMouseEvent(eventName: string, mouseEvent: MouseEvent): void {\n        if (isStopPropagationForAgGrid(mouseEvent)) { return; }\n\n        switch (eventName) {\n            case 'click':\n                this.onCellClicked(mouseEvent);\n                break;\n            case 'mousedown':\n                this.onMouseDown(mouseEvent);\n                break;\n            case 'dblclick':\n                this.onCellDoubleClicked(mouseEvent);\n                break;\n            case 'mouseout':\n                this.onMouseOut(mouseEvent);\n                break;\n            case 'mouseover':\n                this.onMouseOver(mouseEvent);\n                break;\n        }\n    }\n\n    public dispatchCellContextMenuEvent(event: Event | null) {\n        const colDef = this.getComponentHolder();\n        const cellContextMenuEvent: CellContextMenuEvent = this.createEvent(event, Events.EVENT_CELL_CONTEXT_MENU);\n        this.beans.eventService.dispatchEvent(cellContextMenuEvent);\n\n        if (colDef.onCellContextMenu) {\n            // to make the callback async, do in a timeout\n            window.setTimeout(() => (colDef.onCellContextMenu as any)(cellContextMenuEvent), 0);\n        }\n    }\n\n    public createEvent(domEvent: Event | null, eventType: string): CellEvent {\n        const event: CellEvent = {\n            type: eventType,\n            node: this.rowNode,\n            data: this.rowNode.data,\n            value: this.value,\n            column: this.column,\n            colDef: this.getComponentHolder(),\n            context: this.beans.gridOptionsWrapper.getContext(),\n            api: this.beans.gridApi,\n            columnApi: this.beans.columnApi,\n            rowPinned: this.rowNode.rowPinned,\n            event: domEvent,\n            rowIndex: this.rowNode.rowIndex!\n        };\n\n        // because we are hacking in $scope for angular 1, we have to de-reference\n        if (this.scope) {\n            (event as any).$scope = this.scope;\n        }\n\n        return event;\n    }\n\n    private onMouseOut(mouseEvent: MouseEvent): void {\n        const cellMouseOutEvent: CellMouseOutEvent = this.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_OUT);\n        this.beans.eventService.dispatchEvent(cellMouseOutEvent);\n        this.beans.columnHoverService.clearMouseOver();\n    }\n\n    private onMouseOver(mouseEvent: MouseEvent): void {\n        const cellMouseOverEvent: CellMouseOverEvent = this.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_OVER);\n        this.beans.eventService.dispatchEvent(cellMouseOverEvent);\n        this.beans.columnHoverService.setMouseOver([this.column]);\n    }\n\n    private onCellDoubleClicked(mouseEvent: MouseEvent) {\n        const colDef = this.getComponentHolder();\n        // always dispatch event to eventService\n        const cellDoubleClickedEvent: CellDoubleClickedEvent = this.createEvent(mouseEvent, Events.EVENT_CELL_DOUBLE_CLICKED);\n        this.beans.eventService.dispatchEvent(cellDoubleClickedEvent);\n\n        // check if colDef also wants to handle event\n        if (typeof colDef.onCellDoubleClicked === 'function') {\n            // to make the callback async, do in a timeout\n            window.setTimeout(() => (colDef.onCellDoubleClicked as any)(cellDoubleClickedEvent), 0);\n        }\n\n        const editOnDoubleClick = !this.beans.gridOptionsWrapper.isSingleClickEdit()\n            && !this.beans.gridOptionsWrapper.isSuppressClickEdit();\n        if (editOnDoubleClick) {\n            this.startRowOrCellEdit();\n        }\n    }\n\n    // called by rowRenderer when user navigates via tab key\n    public startRowOrCellEdit(keyPress?: number | null, charPress?: string | null): void {\n        if (this.beans.gridOptionsWrapper.isFullRowEdit()) {\n            this.rowComp!.startRowEditing(keyPress, charPress, this);\n        } else {\n            this.startEditingIfEnabled(keyPress, charPress, true);\n        }\n    }\n\n    public isCellEditable() {\n        return this.column.isCellEditable(this.rowNode);\n    }\n\n    // either called internally if single cell editing, or called by rowRenderer if row editing\n    public startEditingIfEnabled(keyPress: number | null = null, charPress: string | null = null, cellStartedEdit = false): void {\n        // don't do it if not editable\n        if (!this.isCellEditable()) { return; }\n\n        // don't do it if already editing\n        if (this.editingCell) { return; }\n\n        this.editingCell = true;\n\n        this.cellEditorVersion++;\n        const callback = this.afterCellEditorCreated.bind(this, this.cellEditorVersion);\n\n        const params = this.createCellEditorParams(keyPress, charPress, cellStartedEdit);\n        this.createCellEditor(params).then(callback);\n\n        // if we don't do this, and editor component is async, then there will be a period\n        // when the component isn't present and keyboard navigation won't work - so example\n        // of user hitting tab quickly (more quickly than renderers getting created) won't work\n        const cellEditorAsync = missing(this.cellEditor);\n\n        if (cellEditorAsync && cellStartedEdit) {\n            this.focusCell(true);\n        }\n    }\n\n    private createCellEditor(params: ICellEditorParams): AgPromise<ICellEditorComp> {\n        const cellEditorPromise = this.beans.userComponentFactory.newCellEditor(this.column.getColDef(), params);\n\n        return cellEditorPromise!.then(cellEditor => {\n            const cellEditorComp = cellEditor!;\n            const isPopup = cellEditorComp.isPopup && cellEditorComp.isPopup();\n\n            if (!isPopup) { return cellEditorComp; }\n\n            if (this.beans.gridOptionsWrapper.isFullRowEdit()) {\n                console.warn('AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both ' +\n                    '- either turn off fullRowEdit, or stop using popup editors.');\n            }\n\n            // if a popup, then we wrap in a popup editor and return the popup\n            const popupEditorWrapper = new PopupEditorWrapper(cellEditorComp);\n            this.beans.context.createBean(popupEditorWrapper);\n            popupEditorWrapper.init(params);\n\n            return popupEditorWrapper;\n        });\n    }\n\n    private afterCellEditorCreated(cellEditorVersion: number, cellEditor: ICellEditorComp): void {\n\n        // if editingCell=false, means user cancelled the editor before component was ready.\n        // if versionMismatch, then user cancelled the edit, then started the edit again, and this\n        //   is the first editor which is now stale.\n        const versionMismatch = cellEditorVersion !== this.cellEditorVersion;\n\n        const cellEditorNotNeeded = versionMismatch || !this.editingCell;\n        if (cellEditorNotNeeded) {\n            this.beans.context.destroyBean(cellEditor);\n            return;\n        }\n\n        const editingCancelledByUserComp = cellEditor.isCancelBeforeStart && cellEditor.isCancelBeforeStart();\n        if (editingCancelledByUserComp) {\n            this.beans.context.destroyBean(cellEditor);\n            this.editingCell = false;\n            return;\n        }\n\n        if (!cellEditor.getGui) {\n            console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`);\n\n            // no getGui, for React guys, see if they attached a react component directly\n            if ((cellEditor as any).render) {\n                console.warn(`AG Grid: we found 'render' on the component, are you trying to set a React renderer but added it as colDef.cellEditor instead of colDef.cellEditorFmk?`);\n            }\n\n            this.beans.context.destroyBean(cellEditor);\n            this.editingCell = false;\n\n            return;\n        }\n\n        this.cellEditor = cellEditor;\n\n        this.cellEditorInPopup = cellEditor.isPopup !== undefined && cellEditor.isPopup();\n        this.setInlineEditingClass();\n\n        if (this.cellEditorInPopup) {\n            this.addPopupCellEditor();\n        } else {\n            this.addInCellEditor();\n        }\n\n        if (cellEditor.afterGuiAttached) {\n            cellEditor.afterGuiAttached();\n        }\n\n        const event: CellEditingStartedEvent = this.createEvent(null, Events.EVENT_CELL_EDITING_STARTED);\n        this.beans.eventService.dispatchEvent(event);\n    }\n\n    private addInCellEditor(): void {\n        const eGui = this.getGui();\n\n        // if focus is inside the cell, we move focus to the cell itself\n        // before removing it's contents, otherwise errors could be thrown.\n        if (eGui.contains(document.activeElement)) {\n            eGui.focus();\n        }\n\n        this.clearCellElement();\n\n        if (this.cellEditor) {\n            eGui.appendChild(this.cellEditor.getGui());\n        }\n\n        this.angular1Compile();\n    }\n\n    private addPopupCellEditor(): void {\n        const ePopupGui = this.cellEditor && this.cellEditor.getGui();\n\n        if (!ePopupGui) { return; }\n\n        const popupService = this.beans.popupService;\n\n        const useModelPopup = this.beans.gridOptionsWrapper.isStopEditingWhenCellsLoseFocus();\n\n        const position = this.cellEditor && this.cellEditor.getPopupPosition ? this.cellEditor.getPopupPosition() : 'over';\n\n        const params = {\n            column: this.column,\n            rowNode: this.rowNode,\n            type: 'popupCellEditor',\n            eventSource: this.getGui(),\n            ePopup: ePopupGui,\n            keepWithinBounds: true\n        };\n\n        const positionCallback = position === 'under' ?\n            popupService.positionPopupUnderComponent.bind(popupService, params)\n            : popupService.positionPopupOverComponent.bind(popupService, params);\n\n        const addPopupRes = popupService.addPopup({\n            modal: useModelPopup,\n            eChild: ePopupGui,\n            closeOnEsc: true,\n            closedCallback: () => { this.onPopupEditorClosed(); },\n            anchorToElement: this.getGui(),\n            positionCallback\n        });\n        if (addPopupRes) {\n            this.hideEditorPopup = addPopupRes.hideFunc;\n        }\n\n        this.angular1Compile();\n    }\n\n    private onPopupEditorClosed(): void {\n        // we only call stopEditing if we are editing, as\n        // it's possible the popup called 'stop editing'\n        // before this, eg if 'enter key' was pressed on\n        // the editor.\n\n        if (!this.editingCell) { return; }\n        // note: this only happens when use clicks outside of the grid. if use clicks on another\n        // cell, then the editing will have already stopped on this cell\n        this.stopRowOrCellEdit();\n    }\n\n    // if we are editing inline, then we don't have the padding in the cell (set in the themes)\n    // to allow the text editor full access to the entire cell\n    private setInlineEditingClass(): void {\n        if (!this.isAlive()) { return; }\n\n        // ag-cell-inline-editing - appears when user is inline editing\n        // ag-cell-not-inline-editing - appears when user is no inline editing\n        // ag-cell-popup-editing - appears when user is editing cell in popup (appears on the cell, not on the popup)\n\n        // note: one of {ag-cell-inline-editing, ag-cell-not-inline-editing} is always present, they toggle.\n        //       however {ag-cell-popup-editing} shows when popup, so you have both {ag-cell-popup-editing}\n        //       and {ag-cell-not-inline-editing} showing at the same time.\n\n        const editingInline = this.editingCell && !this.cellEditorInPopup;\n        const popupEditorShowing = this.editingCell && this.cellEditorInPopup;\n\n        this.addOrRemoveCssClass(CSS_INLINE_EDITING, editingInline);\n        this.addOrRemoveCssClass(CSS_NOT_INLINE_EDITING, !editingInline);\n        this.addOrRemoveCssClass(CSS_POPUP_EDITING, popupEditorShowing);\n        addOrRemoveCssClass(this.getGui().parentNode as HTMLElement, \"ag-row-inline-editing\", editingInline);\n        addOrRemoveCssClass(this.getGui().parentNode as HTMLElement, \"ag-row-not-inline-editing\", !editingInline);\n    }\n\n    private createCellEditorParams(keyPress: number | null, charPress: string | null, cellStartedEdit: boolean): ICellEditorParams {\n        return {\n            value: this.getValue(),\n            keyPress: keyPress,\n            charPress: charPress,\n            column: this.column,\n            colDef: this.column.getColDef(),\n            rowIndex: this.cellPosition.rowIndex,\n            node: this.rowNode,\n            data: this.rowNode.data,\n            api: this.beans.gridOptionsWrapper.getApi(),\n            cellStartedEdit: cellStartedEdit,\n            columnApi: this.beans.gridOptionsWrapper.getColumnApi(),\n            context: this.beans.gridOptionsWrapper.getContext(),\n            $scope: this.scope,\n            onKeyDown: this.onKeyDown.bind(this),\n            stopEditing: this.stopEditingAndFocus.bind(this),\n            eGridCell: this.getGui(),\n            parseValue: this.parseValue.bind(this),\n            formatValue: this.formatValue.bind(this)\n        };\n    }\n\n    // cell editors call this, when they want to stop for reasons other\n    // than what we pick up on. eg selecting from a dropdown ends editing.\n    private stopEditingAndFocus(suppressNavigateAfterEdit = false): void {\n        this.stopRowOrCellEdit();\n        this.focusCell(true);\n\n        if (!suppressNavigateAfterEdit) {\n            this.navigateAfterEdit();\n        }\n    }\n\n    private parseValue(newValue: any): any {\n        const colDef = this.getComponentHolder();\n        const params: NewValueParams = {\n            node: this.rowNode,\n            data: this.rowNode.data,\n            oldValue: this.value,\n            newValue: newValue,\n            colDef: colDef,\n            column: this.column,\n            api: this.beans.gridOptionsWrapper.getApi(),\n            columnApi: this.beans.gridOptionsWrapper.getColumnApi(),\n            context: this.beans.gridOptionsWrapper.getContext()\n        };\n\n        const valueParser = colDef.valueParser;\n\n        return exists(valueParser) ? this.beans.expressionService.evaluate(valueParser, params) : newValue;\n    }\n\n    public focusCell(forceBrowserFocus = false): void {\n        this.beans.focusController.setFocusedCell(this.cellPosition.rowIndex, this.column, this.rowNode.rowPinned, forceBrowserFocus);\n    }\n\n    public setFocusInOnEditor(): void {\n        if (this.editingCell) {\n            if (this.cellEditor && this.cellEditor.focusIn) {\n                // if the editor is present, then we just focus it\n                this.cellEditor.focusIn();\n            } else {\n                // if the editor is not present, it means async cell editor (eg React fibre)\n                // and we are trying to set focus before the cell editor is present, so we\n                // focus the cell instead\n                this.focusCell(true);\n            }\n        }\n    }\n\n    public isEditing(): boolean {\n        return this.editingCell;\n    }\n\n    public onKeyDown(event: KeyboardEvent): void {\n        const key = event.which || event.keyCode;\n\n        switch (key) {\n            case KeyCode.ENTER:\n                this.onEnterKeyDown(event);\n                break;\n            case KeyCode.F2:\n                this.onF2KeyDown();\n                break;\n            case KeyCode.ESCAPE:\n                this.onEscapeKeyDown();\n                break;\n            case KeyCode.TAB:\n                this.onTabKeyDown(event);\n                break;\n            case KeyCode.BACKSPACE:\n            case KeyCode.DELETE:\n                this.onBackspaceOrDeleteKeyPressed(key);\n                break;\n            case KeyCode.DOWN:\n            case KeyCode.UP:\n            case KeyCode.RIGHT:\n            case KeyCode.LEFT:\n                this.onNavigationKeyPressed(event, key);\n                break;\n        }\n    }\n\n    public setFocusOutOnEditor(): void {\n        if (this.editingCell && this.cellEditor && this.cellEditor.focusOut) {\n            this.cellEditor.focusOut();\n        }\n    }\n\n    private onNavigationKeyPressed(event: KeyboardEvent, key: number): void {\n        if (this.editingCell) { return; }\n\n        if (event.shiftKey && this.rangeSelectionEnabled) {\n            this.onShiftRangeSelect(key);\n        } else {\n            this.beans.rowRenderer.navigateToNextCell(event, key, this.cellPosition, true);\n        }\n\n        // if we don't prevent default, the grid will scroll with the navigation keys\n        event.preventDefault();\n    }\n\n    private onShiftRangeSelect(key: number): void {\n        if (!this.beans.rangeController) { return; }\n\n        const endCell = this.beans.rangeController.extendLatestRangeInDirection(key);\n\n        if (endCell) {\n            this.beans.rowRenderer.ensureCellVisible(endCell);\n        }\n    }\n\n    private onTabKeyDown(event: KeyboardEvent): void {\n        this.beans.rowRenderer.onTabKeyDown(this, event);\n    }\n\n    private onBackspaceOrDeleteKeyPressed(key: number): void {\n        if (!this.editingCell) {\n            this.startRowOrCellEdit(key);\n        }\n    }\n\n    private onEnterKeyDown(e: KeyboardEvent): void {\n        if (this.editingCell || this.rowComp!.isEditing()) {\n            this.stopEditingAndFocus();\n        } else {\n            if (this.beans.gridOptionsWrapper.isEnterMovesDown()) {\n                this.beans.rowRenderer.navigateToNextCell(null, KeyCode.DOWN, this.cellPosition, false);\n            } else {\n                this.startRowOrCellEdit(KeyCode.ENTER);\n                if (this.editingCell) {\n                    // if we started editing, then we need to prevent default, otherwise the Enter action can get\n                    // applied to the cell editor. this happened, for example, with largeTextCellEditor where not\n                    // preventing default results in a 'new line' character getting inserted in the text area\n                    // when the editing was started\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n\n    private navigateAfterEdit(): void {\n        const fullRowEdit = this.beans.gridOptionsWrapper.isFullRowEdit();\n\n        if (fullRowEdit) { return; }\n\n        const enterMovesDownAfterEdit = this.beans.gridOptionsWrapper.isEnterMovesDownAfterEdit();\n\n        if (enterMovesDownAfterEdit) {\n            this.beans.rowRenderer.navigateToNextCell(null, KeyCode.DOWN, this.cellPosition, false);\n        }\n    }\n\n    private onF2KeyDown(): void {\n        if (!this.editingCell) {\n            this.startRowOrCellEdit(KeyCode.F2);\n        }\n    }\n\n    private onEscapeKeyDown(): void {\n        if (this.editingCell) {\n            this.stopRowOrCellEdit(true);\n            this.focusCell(true);\n        }\n    }\n\n    public onKeyPress(event: KeyboardEvent): void {\n        // check this, in case focus is on a (for example) a text field inside the cell,\n        // in which cse we should not be listening for these key pressed\n        const eventTarget = getTarget(event);\n        const eventOnChildComponent = eventTarget !== this.getGui();\n\n        if (eventOnChildComponent || this.editingCell) { return; }\n\n        const pressedChar = String.fromCharCode(event.charCode);\n        if (pressedChar === ' ') {\n            this.onSpaceKeyPressed(event);\n        } else if (isEventFromPrintableCharacter(event)) {\n            this.startRowOrCellEdit(null, pressedChar);\n            // if we don't prevent default, then the keypress also gets applied to the text field\n            // (at least when doing the default editor), but we need to allow the editor to decide\n            // what it wants to do. we only do this IF editing was started - otherwise it messes\n            // up when the use is not doing editing, but using rendering with text fields in cellRenderer\n            // (as it would block the the user from typing into text fields).\n            event.preventDefault();\n        }\n    }\n\n    private onSpaceKeyPressed(event: KeyboardEvent): void {\n        const { gridOptionsWrapper } = this.beans;\n\n        if (!this.editingCell && gridOptionsWrapper.isRowSelection()) {\n            const currentSelection = this.rowNode.isSelected();\n            const newSelection = !currentSelection;\n            if (newSelection || !gridOptionsWrapper.isSuppressRowDeselection()) {\n                const groupSelectsFiltered = this.beans.gridOptionsWrapper.isGroupSelectsFiltered();\n                const updatedCount = this.rowNode.setSelectedParams({\n                    newValue: newSelection,\n                    rangeSelect: event.shiftKey,\n                    groupSelectsFiltered: groupSelectsFiltered\n                });\n                if (currentSelection === undefined && updatedCount === 0) {\n                    this.rowNode.setSelectedParams({\n                        newValue: false,\n                        rangeSelect: event.shiftKey,\n                        groupSelectsFiltered: groupSelectsFiltered\n                    });\n                }\n            }\n        }\n\n        // prevent default as space key, by default, moves browser scroll down\n        event.preventDefault();\n    }\n\n    private onMouseDown(mouseEvent: MouseEvent): void {\n        const { ctrlKey, metaKey, shiftKey } = mouseEvent;\n        const target = mouseEvent.target as HTMLElement;\n        const { eventService, rangeController } = this.beans;\n\n        // do not change the range for right-clicks inside an existing range\n        if (this.isRightClickInExistingRange(mouseEvent)) {\n            return;\n        }\n\n        if (!shiftKey || (rangeController && !rangeController.getCellRanges().length)) {\n            // We only need to pass true to focusCell when the browser is IE/Edge and we are trying\n            // to focus the cell itself. This should never be true if the mousedown was triggered\n            // due to a click on a cell editor for example.\n            const forceBrowserFocus = (isBrowserIE() || isBrowserEdge()) && !this.editingCell && !isFocusableFormField(target);\n\n            this.focusCell(forceBrowserFocus);\n        } else if (rangeController) {\n            // if a range is being changed, we need to make sure the focused cell does not change.\n            mouseEvent.preventDefault();\n        }\n\n        // if we are clicking on a checkbox, we need to make sure the cell wrapping that checkbox\n        // is focused but we don't want to change the range selection, so return here.\n        if (this.containsWidget(target)) { return; }\n\n        if (rangeController) {\n            const thisCell = this.cellPosition;\n\n            if (shiftKey) {\n                rangeController.extendLatestRangeToCell(thisCell);\n            } else {\n                const ctrlKeyPressed = ctrlKey || metaKey;\n                rangeController.setRangeToCell(thisCell, ctrlKeyPressed);\n            }\n        }\n\n        eventService.dispatchEvent(this.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_DOWN));\n    }\n\n    private isRightClickInExistingRange(mouseEvent: MouseEvent): boolean {\n        const { rangeController } = this.beans;\n\n        if (rangeController) {\n            const cellInRange = rangeController.isCellInAnyRange(this.getCellPosition());\n\n            if (cellInRange && mouseEvent.button === 2) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    private containsWidget(target: HTMLElement): boolean {\n        return isElementChildOfClass(target, 'ag-selection-checkbox', 3);\n    }\n\n    // returns true if on iPad and this is second 'click' event in 200ms\n    private isDoubleClickOnIPad(): boolean {\n        if (!isIOSUserAgent() || isEventSupported('dblclick')) { return false; }\n\n        const nowMillis = new Date().getTime();\n        const res = nowMillis - this.lastIPadMouseClickEvent < 200;\n        this.lastIPadMouseClickEvent = nowMillis;\n\n        return res;\n    }\n\n    private onCellClicked(mouseEvent: MouseEvent): void {\n        // iPad doesn't have double click - so we need to mimic it to enable editing for iPad.\n        if (this.isDoubleClickOnIPad()) {\n            this.onCellDoubleClicked(mouseEvent);\n            mouseEvent.preventDefault(); // if we don't do this, then iPad zooms in\n\n            return;\n        }\n\n        const { eventService, gridOptionsWrapper } = this.beans;\n\n        const cellClickedEvent: CellClickedEvent = this.createEvent(mouseEvent, Events.EVENT_CELL_CLICKED);\n        eventService.dispatchEvent(cellClickedEvent);\n\n        const colDef = this.getComponentHolder();\n\n        if (colDef.onCellClicked) {\n            // to make callback async, do in a timeout\n            window.setTimeout(() => colDef.onCellClicked!(cellClickedEvent), 0);\n        }\n\n        const editOnSingleClick = (gridOptionsWrapper.isSingleClickEdit() || colDef.singleClickEdit)\n            && !gridOptionsWrapper.isSuppressClickEdit();\n\n        if (editOnSingleClick) {\n            this.startRowOrCellEdit();\n        }\n    }\n\n    private createGridCellVo(): void {\n        this.cellPosition = {\n            rowIndex: this.rowNode.rowIndex!,\n            rowPinned: this.rowNode.rowPinned,\n            column: this.column\n        };\n    }\n\n    public getRowPosition(): RowPosition {\n        return {\n            rowIndex: this.cellPosition.rowIndex,\n            rowPinned: this.cellPosition.rowPinned\n        };\n    }\n\n    public getCellPosition(): CellPosition {\n        return this.cellPosition;\n    }\n\n    public getParentRow(): HTMLElement {\n        return this.eRow;\n    }\n\n    public setParentRow(eParentRow: HTMLElement): void {\n        this.eRow = eParentRow;\n    }\n\n    public getColumn(): Column {\n        return this.column;\n    }\n\n    public getComponentHolder(): ColDef {\n        return this.column.getColDef();\n    }\n\n    public detach(): void {\n        this.eRow.removeChild(this.getGui());\n    }\n\n    // if the row is also getting destroyed, then we don't need to remove from dom,\n    // as the row will also get removed, so no need to take out the cells from the row\n    // if the row is going (removing is an expensive operation, so only need to remove\n    // the top part)\n    //\n    // note - this is NOT called by context, as we don't wire / unwire the CellComp for performance reasons.\n    public destroy(): void {\n        if (this.createCellRendererFunc) {\n            this.beans.taskQueue.cancelTask(this.createCellRendererFunc);\n        }\n\n        this.stopEditing();\n        this.cellRenderer = this.beans.context.destroyBean(this.cellRenderer);\n        this.beans.context.destroyBean(this.selectionHandle);\n\n        super.destroy();\n    }\n\n    public onLeftChanged(): void {\n        const left = this.modifyLeftForPrintLayout(this.getCellLeft());\n        this.getGui().style.left = left + 'px';\n        this.refreshAriaIndex();\n    }\n\n    private modifyLeftForPrintLayout(leftPosition: number | null): number | null {\n        if (!this.printLayout || this.column.getPinned() === Constants.PINNED_LEFT) {\n            return leftPosition;\n        }\n\n        const leftWidth = this.beans.columnController.getDisplayedColumnsLeftWidth();\n\n        if (this.column.getPinned() === Constants.PINNED_RIGHT) {\n            const bodyWidth = this.beans.columnController.getBodyContainerWidth();\n            return leftWidth + bodyWidth + (leftPosition || 0);\n        }\n\n        // is in body\n        return leftWidth + (leftPosition || 0);\n    }\n\n    public onWidthChanged(): void {\n        const width = this.getCellWidth();\n        this.getGui().style.width = `${width}px`;\n    }\n\n    private getRangeBorders(): {\n        top: boolean,\n        right: boolean,\n        bottom: boolean,\n        left: boolean;\n    } {\n        const isRtl = this.beans.gridOptionsWrapper.isEnableRtl();\n\n        let top = false;\n        let right = false;\n        let bottom = false;\n        let left = false;\n\n        const thisCol = this.cellPosition.column;\n        const { rangeController, columnController } = this.beans;\n\n        let leftCol: Column | null;\n        let rightCol: Column | null;\n\n        if (isRtl) {\n            leftCol = columnController.getDisplayedColAfter(thisCol);\n            rightCol = columnController.getDisplayedColBefore(thisCol);\n        } else {\n            leftCol = columnController.getDisplayedColBefore(thisCol);\n            rightCol = columnController.getDisplayedColAfter(thisCol);\n        }\n\n        const ranges = rangeController.getCellRanges().filter(\n            range => rangeController.isCellInSpecificRange(this.cellPosition, range)\n        );\n\n        // this means we are the first column in the grid\n        if (!leftCol) {\n            left = true;\n        }\n\n        // this means we are the last column in the grid\n        if (!rightCol) {\n            right = true;\n        }\n\n        for (let i = 0; i < ranges.length; i++) {\n            if (top && right && bottom && left) { break; }\n\n            const range = ranges[i];\n            const startRow = rangeController.getRangeStartRow(range);\n            const endRow = rangeController.getRangeEndRow(range);\n\n            if (!top && this.beans.rowPositionUtils.sameRow(startRow, this.cellPosition)) {\n                top = true;\n            }\n\n            if (!bottom && this.beans.rowPositionUtils.sameRow(endRow, this.cellPosition)) {\n                bottom = true;\n            }\n\n            if (!left && leftCol && range.columns.indexOf(leftCol) < 0) {\n                left = true;\n            }\n\n            if (!right && rightCol && range.columns.indexOf(rightCol) < 0) {\n                right = true;\n            }\n        }\n\n        return { top, right, bottom, left };\n    }\n\n    private getInitialRangeClasses(): string[] {\n        const classes: string[] = [];\n\n        if (!this.rangeSelectionEnabled || !this.rangeCount) {\n            return classes;\n        }\n\n        classes.push(CSS_RANGE_SELECTED);\n\n        if (this.hasChartRange) {\n            classes.push(CSS_RANGE_CHART);\n        }\n\n        const count = Math.min(this.rangeCount, 4);\n\n        classes.push(`${CSS_RANGE_SELECTED}-${count}`);\n\n        if (this.isSingleCell()) {\n            classes.push(CSS_RANGE_SINGLE_CELL);\n        }\n\n        if (this.rangeCount > 0) {\n            const borders = this.getRangeBorders();\n\n            if (borders.top) { classes.push(CSS_RANGE_TOP); }\n            if (borders.right) { classes.push(CSS_RANGE_RIGHT); }\n            if (borders.bottom) { classes.push(CSS_RANGE_BOTTOM); }\n            if (borders.left) { classes.push(CSS_RANGE_LEFT); }\n        }\n\n        if (!!this.selectionHandle) {\n            classes.push(CSS_RANGE_HANDLE);\n        }\n\n        return classes;\n    }\n\n    public onRowIndexChanged(): void {\n        // when index changes, this influences items that need the index, so we update the\n        // grid cell so they are working off the new index.\n        this.createGridCellVo();\n        // when the index of the row changes, ie means the cell may have lost or gained focus\n        this.onCellFocused();\n        // check range selection\n        this.onRangeSelectionChanged();\n    }\n\n    public onRangeSelectionChanged(): void {\n        const { rangeController } = this.beans;\n\n        if (!rangeController) { return; }\n\n        const { cellPosition, rangeCount } = this;\n\n        const newRangeCount = rangeController.getCellRangeCount(cellPosition);\n        const element = this.getGui();\n\n        if (rangeCount !== newRangeCount) {\n            this.addOrRemoveCssClass(CSS_RANGE_SELECTED, newRangeCount !== 0);\n            this.addOrRemoveCssClass(`${CSS_RANGE_SELECTED}-1`, newRangeCount === 1);\n            this.addOrRemoveCssClass(`${CSS_RANGE_SELECTED}-2`, newRangeCount === 2);\n            this.addOrRemoveCssClass(`${CSS_RANGE_SELECTED}-3`, newRangeCount === 3);\n            this.addOrRemoveCssClass(`${CSS_RANGE_SELECTED}-4`, newRangeCount >= 4);\n            this.rangeCount = newRangeCount;\n        }\n\n        setAriaSelected(element, this.rangeCount > 0);\n\n        const hasChartRange = this.getHasChartRange();\n\n        if (hasChartRange !== this.hasChartRange) {\n            this.hasChartRange = hasChartRange;\n            this.addOrRemoveCssClass(CSS_RANGE_CHART, this.hasChartRange);\n        }\n\n        this.updateRangeBorders();\n\n        this.addOrRemoveCssClass(CSS_RANGE_SINGLE_CELL, this.isSingleCell());\n\n        this.refreshHandle();\n    }\n\n    private getHasChartRange(): boolean {\n        const { rangeController } = this.beans;\n\n        if (!this.rangeCount || !rangeController) {\n            return false;\n        }\n\n        const cellRanges = rangeController.getCellRanges();\n\n        return cellRanges.length > 0 && cellRanges.every(range => includes([CellRangeType.DIMENSION, CellRangeType.VALUE], range.type));\n    }\n\n    private shouldHaveSelectionHandle(): boolean {\n        const { gridOptionsWrapper, rangeController } = this.beans;\n        const cellRanges = rangeController.getCellRanges();\n        const rangesLen = cellRanges.length;\n\n        if (this.rangeCount < 1 || rangesLen < 1) {\n            return false;\n        }\n\n        const cellRange = last(cellRanges);\n        const cellPosition = this.getCellPosition();\n        let fillHandleIsAvailable = rangesLen === 1 &&\n            (gridOptionsWrapper.isEnableFillHandle() || gridOptionsWrapper.isEnableRangeHandle()) &&\n            !this.editingCell;\n\n        if (this.hasChartRange) {\n            const hasCategoryRange = cellRanges[0].type === CellRangeType.DIMENSION;\n            const isCategoryCell = hasCategoryRange && rangeController.isCellInSpecificRange(cellPosition, cellRanges[0]);\n\n            this.addOrRemoveCssClass(CSS_RANGE_CHART_CATEGORY, isCategoryCell);\n            fillHandleIsAvailable = cellRange.type === CellRangeType.VALUE;\n        }\n\n        return fillHandleIsAvailable &&\n            cellRange.endRow != null &&\n            rangeController.isContiguousRange(cellRange) &&\n            rangeController.isBottomRightCell(cellRange, cellPosition);\n    }\n\n    private addSelectionHandle() {\n        const { gridOptionsWrapper, rangeController } = this.beans;\n        const cellRangeType = last(rangeController.getCellRanges()).type;\n        const selectionHandleFill = gridOptionsWrapper.isEnableFillHandle() && missing(cellRangeType);\n        const type = selectionHandleFill ? SelectionHandleType.FILL : SelectionHandleType.RANGE;\n\n        if (this.selectionHandle && this.selectionHandle.getType() !== type) {\n            this.selectionHandle = this.beans.context.destroyBean(this.selectionHandle);\n        }\n\n        if (!this.selectionHandle) {\n            this.selectionHandle = this.beans.selectionHandleFactory.createSelectionHandle(type);\n        }\n\n        this.selectionHandle.refresh(this);\n    }\n\n    public updateRangeBordersIfRangeCount(): void {\n        // we only need to update range borders if we are in a range\n        if (this.rangeCount > 0) {\n            this.updateRangeBorders();\n            this.refreshHandle();\n        }\n    }\n\n    private refreshHandle(): void {\n        if (!this.beans.rangeController) { return; }\n\n        const shouldHaveSelectionHandle = this.shouldHaveSelectionHandle();\n\n        if (this.selectionHandle && !shouldHaveSelectionHandle) {\n            this.selectionHandle = this.beans.context.destroyBean(this.selectionHandle);\n        }\n\n        if (shouldHaveSelectionHandle) {\n            this.addSelectionHandle();\n        }\n\n        this.addOrRemoveCssClass(CSS_RANGE_HANDLE, !!this.selectionHandle);\n    }\n\n    private updateRangeBorders(): void {\n        const rangeBorders = this.getRangeBorders();\n        const isSingleCell = this.isSingleCell();\n        const isTop = !isSingleCell && rangeBorders.top;\n        const isRight = !isSingleCell && rangeBorders.right;\n        const isBottom = !isSingleCell && rangeBorders.bottom;\n        const isLeft = !isSingleCell && rangeBorders.left;\n\n        this.addOrRemoveCssClass(CSS_RANGE_TOP, isTop);\n        this.addOrRemoveCssClass(CSS_RANGE_RIGHT, isRight);\n        this.addOrRemoveCssClass(CSS_RANGE_BOTTOM, isBottom);\n        this.addOrRemoveCssClass(CSS_RANGE_LEFT, isLeft);\n    }\n\n    public onFirstRightPinnedChanged(): void {\n        const firstRightPinned = this.column.isFirstRightPinned();\n\n        if (this.firstRightPinned !== firstRightPinned) {\n            this.firstRightPinned = firstRightPinned;\n            this.addOrRemoveCssClass(CSS_FIRST_RIGHT_PINNED, firstRightPinned);\n        }\n    }\n\n    public onLastLeftPinnedChanged(): void {\n        const lastLeftPinned = this.column.isLastLeftPinned();\n\n        if (this.lastLeftPinned !== lastLeftPinned) {\n            this.lastLeftPinned = lastLeftPinned;\n            this.addOrRemoveCssClass(CSS_LAST_LEFT_PINNED, lastLeftPinned);\n        }\n    }\n\n    public refreshShouldDestroy(): boolean {\n        const isUsingWrapper = this.usingWrapper;\n        const isIncludingRowDragging = this.includeRowDraggingComponent;\n        const isIncludingDndSource = this.includeDndSourceComponent;\n        const isIncludingSelection = this.includeSelectionComponent;\n\n        this.setUsingWrapper();\n\n        return isUsingWrapper !== this.usingWrapper ||\n            isIncludingRowDragging !== this.includeRowDraggingComponent ||\n            isIncludingDndSource !== this.includeDndSourceComponent ||\n            isIncludingSelection !== this.includeSelectionComponent;\n    }\n\n    private populateTemplate(): void {\n        if (this.usingWrapper) {\n\n            this.eCellValue = this.getRefElement('eCellValue');\n            this.eCellWrapper = this.getRefElement('eCellWrapper');\n            this.eCellValue.id = `cell-${this.getCompId()}`;\n            let describedByIds = '';\n\n            if (this.includeRowDraggingComponent) {\n                this.addRowDragging();\n            }\n\n            if (this.includeDndSourceComponent) {\n                this.addDndSource();\n            }\n\n            if (this.includeSelectionComponent) {\n                describedByIds += this.addSelectionCheckbox().getCheckboxId();\n            }\n\n            setAriaDescribedBy(this.getGui(), `${describedByIds} ${this.eCellValue.id}`.trim());\n        } else {\n            this.eCellValue = this.getGui();\n            this.eCellWrapper = this.eCellValue;\n        }\n    }\n\n    protected getFrameworkOverrides(): IFrameworkOverrides {\n        return this.beans.frameworkOverrides;\n    }\n\n    private addRowDragging(customElement?: HTMLElement, dragStartPixels?: number): void {\n        const pagination = this.beans.gridOptionsWrapper.isPagination();\n        const rowDragManaged = this.beans.gridOptionsWrapper.isRowDragManaged();\n        const clientSideRowModelActive = this.beans.gridOptionsWrapper.isRowModelDefault();\n\n        if (rowDragManaged) {\n            // row dragging only available in default row model\n            if (!clientSideRowModelActive) {\n                doOnce(() => console.warn('AG Grid: managed row dragging is only allowed in the Client Side Row Model'),\n                    'CellComp.addRowDragging');\n\n                return;\n            }\n\n            if (pagination) {\n                doOnce(() => console.warn('AG Grid: managed row dragging is not possible when doing pagination'),\n                    'CellComp.addRowDragging');\n\n                return;\n            }\n        }\n        if (!this.rowDraggingComp) {\n            this.rowDraggingComp = new RowDragComp(() => this.value, this.rowNode, this.column, customElement, dragStartPixels);\n            this.createManagedBean(this.rowDraggingComp, this.beans.context);\n        } else if (customElement) {\n            // if the rowDraggingComp is already present, means we should only set the drag element\n            this.rowDraggingComp.setDragElement(customElement, dragStartPixels);\n        }\n\n        // If there is a custom element, the Cell Renderer is responsible for displaying it.\n        if (!customElement) {\n            // put the checkbox in before the value\n            this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(), this.eCellValue);\n        }\n    }\n\n    private addDndSource(): void {\n        const dndSourceComp = new DndSourceComp(this.rowNode, this.column, this.beans, this.getGui());\n        this.createManagedBean(dndSourceComp, this.beans.context);\n\n        // put the checkbox in before the value\n        this.eCellWrapper.insertBefore(dndSourceComp.getGui(), this.eCellValue);\n    }\n\n    private addSelectionCheckbox(): CheckboxSelectionComponent {\n        const cbSelectionComponent = new CheckboxSelectionComponent();\n        this.beans.context.createBean(cbSelectionComponent);\n\n        let visibleFunc = this.getComponentHolder().checkboxSelection;\n\n        if (typeof visibleFunc !== 'function') {\n            visibleFunc = undefined;\n        }\n\n        cbSelectionComponent.init({ rowNode: this.rowNode, column: this.column });\n        this.addDestroyFunc(() => this.beans.context.destroyBean(cbSelectionComponent));\n\n        // put the checkbox in before the value\n        this.eCellWrapper.insertBefore(cbSelectionComponent.getGui(), this.eCellValue);\n        return cbSelectionComponent;\n    }\n\n    private addDomData(): void {\n        const element = this.getGui();\n        this.beans.gridOptionsWrapper.setDomData(element, CellComp.DOM_DATA_KEY_CELL_COMP, this);\n\n        this.addDestroyFunc(() => this.beans.gridOptionsWrapper.setDomData(element, CellComp.DOM_DATA_KEY_CELL_COMP, null));\n    }\n\n    private isSingleCell(): boolean {\n        const { rangeController } = this.beans;\n\n        return this.rangeCount === 1 && rangeController && !rangeController.isMoreThanOneCell();\n    }\n\n    public onCellFocused(event?: any): void {\n        const cellFocused = this.beans.focusController.isCellFocused(this.cellPosition);\n\n        // see if we need to change the classes on this cell\n        if (cellFocused !== this.cellFocused) {\n            // if we are not doing cell selection, then the focus class does not change\n            const doingFocusCss = !this.beans.gridOptionsWrapper.isSuppressCellSelection();\n\n            if (doingFocusCss) {\n                this.addOrRemoveCssClass(CSS_CELL_FOCUS, cellFocused);\n            }\n\n            this.cellFocused = cellFocused;\n        }\n\n        // see if we need to force browser focus - this can happen if focus is programmatically set\n        if (cellFocused && event && event.forceBrowserFocus) {\n            const focusEl = this.getFocusableElement();\n            focusEl.focus();\n            // Fix for AG-3465 \"IE11 - After editing cell's content, selection doesn't go one cell below on enter\"\n            // IE can fail to focus the cell after the first call to focus(), and needs a second call\n            if (!document.activeElement || document.activeElement === document.body) {\n                focusEl.focus();\n            }\n        }\n\n        // if another cell was focused, and we are editing, then stop editing\n        const fullRowEdit = this.beans.gridOptionsWrapper.isFullRowEdit();\n\n        if (!cellFocused && !fullRowEdit && this.editingCell) {\n            this.stopRowOrCellEdit();\n        }\n    }\n\n    // pass in 'true' to cancel the editing.\n    public stopRowOrCellEdit(cancel: boolean = false) {\n        if (this.beans.gridOptionsWrapper.isFullRowEdit()) {\n            this.rowComp!.stopRowEditing(cancel);\n        } else {\n            this.stopEditing(cancel);\n        }\n    }\n\n    public stopEditing(cancel = false): void {\n        if (!this.editingCell) { return; }\n\n        // if no cell editor, this means due to async, that the cell editor never got initialised,\n        // so we just carry on regardless as if the editing was never started.\n        if (!this.cellEditor) {\n            this.editingCell = false;\n            return;\n        }\n\n        const oldValue = this.getValue();\n        let newValueExists = false;\n        let newValue: any;\n\n        if (!cancel) {\n            // also have another option here to cancel after editing, so for example user could have a popup editor and\n            // it is closed by user clicking outside the editor. then the editor will close automatically (with false\n            // passed above) and we need to see if the editor wants to accept the new value.\n            const userWantsToCancel = this.cellEditor.isCancelAfterEnd && this.cellEditor.isCancelAfterEnd();\n\n            if (!userWantsToCancel) {\n                newValue = this.cellEditor.getValue();\n                newValueExists = true;\n            }\n        }\n\n        // it is important we set this after setValue() above, as otherwise the cell will flash\n        // when editing stops. the 'refresh' method checks editing, and doesn't refresh editing cells.\n        // thus it will skip the refresh on this cell until the end of this method where we call\n        // refresh directly and we suppress the flash.\n        this.editingCell = false;\n\n        // important to clear this out - as parts of the code will check for\n        // this to see if an async cellEditor has yet to be created\n        this.beans.context.destroyBean(this.cellEditor);\n        this.cellEditor = null;\n\n        if (this.cellEditorInPopup && this.hideEditorPopup) {\n            this.hideEditorPopup();\n            this.hideEditorPopup = null;\n        } else {\n            this.clearCellElement();\n\n            const eGui = this.getGui();\n            // put the cell back the way it was before editing\n            if (this.usingWrapper) {\n                // if wrapper, then put the wrapper back\n                eGui.appendChild(this.eCellWrapper);\n            } else if (this.cellRenderer) {\n                // if cellRenderer, then put the gui back in. if the renderer has\n                // a refresh, it will be called. however if it doesn't, then later\n                // the renderer will be destroyed and a new one will be created.\n                // we know it's a dom element (not a string) because we converted\n                // it after the gui was attached if it was a string.\n                const eCell = this.cellRendererGui as HTMLElement;\n\n                // can be null if cell was previously null / contained empty string,\n                // this will result in new value not being rendered.\n                if (eCell) {\n                    eGui.appendChild(eCell);\n                }\n            }\n        }\n\n        this.setInlineEditingClass();\n        this.refreshHandle();\n\n        if (newValueExists && newValue !== oldValue) {\n            // we suppressRefreshCell because the call to rowNode.setDataValue() results in change detection\n            // getting triggered, which results in all cells getting refreshed. we do not want this refresh\n            // to happen on this call as we want to call it explicitly below. otherwise refresh gets called twice.\n            // if we only did this refresh (and not the one below) then the cell would flash and not be forced.\n            this.suppressRefreshCell = true;\n            this.rowNode.setDataValue(this.column, newValue);\n            this.suppressRefreshCell = false;\n        }\n\n        // we suppress the flash, as it is not correct to flash the cell the user has finished editing,\n        // the user doesn't need to flash as they were the one who did the edit, the flash is pointless\n        // (as the flash is meant to draw the user to a change that they didn't manually do themselves).\n        this.refreshCell({ forceRefresh: true, suppressFlash: true });\n\n        const editingStoppedEvent = {\n            ...this.createEvent(null, Events.EVENT_CELL_EDITING_STOPPED),\n            oldValue,\n            newValue\n        };\n\n        this.beans.eventService.dispatchEvent(editingStoppedEvent);\n    }\n\n    private clearCellElement(): void {\n        const eGui = this.getGui();\n\n        // if focus is inside the cell, we move focus to the cell itself\n        // before removing it's contents, otherwise errors could be thrown.\n        if (eGui.contains(document.activeElement) && !isBrowserIE()) {\n            eGui.focus({\n                preventScroll: true\n            });\n        }\n\n        clearElement(eGui);\n    }\n}\n"]}